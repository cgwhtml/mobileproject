<!DOCTYPE html>
<html>
<head>
    <title>出牙记录</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/web-bin/resources/flexible/flexible.css">
    <link type="text/css" rel="stylesheet" href="/web-bin/resources/mobiscroll/css/mobiscroll.css">
    <link type="text/css" rel="stylesheet" href="/web-bin/resources/mobiscroll/css/mobiscroll_002.css">
    <link type="text/css" rel="stylesheet" href="/web-bin/resources/mobiscroll/css/mobiscroll_003.css">
    <link type="text/css" rel="stylesheet" href="/web-bin/mobile/followup/maternalChild/handBook/write/basic.css">
    <style>
        .table_title{
            color: #ED9DD6;
            font-size: 0.4rem;
            text-align: center;
        }
        .add_table{
            background: #fff;
            padding-bottom: 0.2rem;
        }
        .table_detail{
            padding: 0.21rem 0.4rem 0 0.4rem;
        }
        .content_table{
            width: 100%;
            text-align: center;
        }
        .number{
            width: 20%;
        }
        .teeth_date{
            width: 30%;
        }
        .content_table tr td{
            height: 0.8rem;
            text-align: center;
            border-left: 1px solid #ED9DD6;
        }
        .content_table tr td input{
            width: 90% !important;
            margin-left: 0.1rem;
            font-family: "Microsoft YaHei","微软雅黑";
            font-size:0.32rem;
            border:1px solid transparent !important;
            box-sizing: border-box;
            color:#333;
            -webkit-tap-highlight-color: transparent;
            -webkit-appearance:none;
            -webkit-opacity:1;
            opacity: 1;
        }
        .content_table tr td:last-child{
            border-right: 1px solid #ED9DD6;
        }
        .content_table tr:first-child{
            background-color: #FBE9F5;
            border-top: 1px solid #ED9DD6;
        }
        .content_table tr:last-child{
            border-bottom: 1px solid #ED9DD6;
        }
    </style>
</head>
<body>
    <form action="" id="myForm" name="myForm">
        <div class="parent_msg">
            <div class="main_option">
                <span>开始长牙月龄（个月）</span>
                <input type="text" placeholder="请填写" class="input_msg" id="startTeethMonth" name="startTeethMonth">
            </div>
            <div class="add_table">
                <div class="teeth_img"></div>
                <p class="table_title">出牙日期</p>
                <div class="table_detail">
                    <table cellspacing="1" cellpadding="0" border="0" class="content_table">
                        <tr>
                            <td class="number">序号</td>
                            <td class="teeth_date">日期</td>
                            <td class="number">序号</td>
                            <td class="teeth_date">日期</td>
                        </tr>
                        <tr>
                            <td class="bg_gray">1</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="oneTeethDate" name="oneTeethDate">
                            </td>
                            <td>10</td>
                            <td>
                                <input id="tenTeethDate" name="tenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>
                                <input id="twoTeethDate" name="twoTeethDate">
                            </td>
                            <td class="bg_gray">11</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="elevenTeethDate" name="elevenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td class="bg_gray">3</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="threeTeethDate" name="threeTeethDate">
                            </td>
                            <td>12</td>
                            <td>
                                <input id="twelveTeethDate" name="twelveTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>
                                <input id="fourTeethDate" name="fourTeethDate">
                            </td>
                            <td class="bg_gray">13</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="thirteenTeethDate" name="thirteenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td class="bg_gray">5</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="fiveTeethDate" name="fiveTeethDate">
                            </td>
                            <td>14</td>
                            <td>
                                <input id="fourteenTeethDate" name="fourteenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>
                                <input id="sixTeethDate" name="sixTeethDate">
                            </td>
                            <td class="bg_gray">15</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="fifteenTeethDate" name="fifteenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td class="bg_gray">7</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="sevenTeethDate" name="sevenTeethDate">
                            </td>
                            <td>16</td>
                            <td>
                                <input id="sixteenTeethDate" name="sixteenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>
                                <input id="eightTeethDate" name="eightTeethDate">
                            </td>
                            <td class="bg_gray">17</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="seventeenTeethDate" name="seventeenTeethDate">
                            </td>
                        </tr>
                        <tr>
                            <td class="bg_gray">9</td>
                            <td class="bg_gray">
                                <input class="bg_gray" id="nineTeethDate" name="nineTeethDate">
                            </td>
                            <td>18</td>
                            <td>
                                <input id="eighteenTeethDate" name="eighteenTeethDate">
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </form>
    <div class="page_btns">
        <div class="pink_btn save">保存</div>
    </div>
    <div id="window"  style="display:none" class="window">
        <div>
            <div id="window_in" class="window_in"></div>
            <div id="check" class="check">确定</div>
        </div>
    </div>
    <div id="background" style="display: none"></div>
    <div id="fake_alert"  style="display:none">
        <div id="fake_alert_in">
            <div id="msg"></div>
            <div id="sure">确定</div>
        </div>
    </div>
    <input type="hidden" id="data_id">
    <script type="text/javascript" src="/web-bin/resources/jquery/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/web-bin/resources/config/config.js"></script>
    <script type="text/javascript" src="/web-bin/resources/flexible/flexible.js"></script>
    <script type="text/javascript" src="/web-bin/resources/mobiscroll/js/mobiscroll_002.js"></script>
    <script type="text/javascript" src="/web-bin/resources/mobiscroll/js/mobiscroll_004.js"></script>
    <script type="text/javascript" src="/web-bin/resources/mobiscroll/js/mobiscroll.js"></script>
    <script type="text/javascript" src="/web-bin/resources/mobiscroll/js/mobiscroll_003.js"></script>
    <script type="text/javascript" src="/web-bin/resources/mobiscroll/js/mobiscroll_005.js"></script>
    <script>
        $(function(){
            var localhostUrl=window.location.origin;
            var query=getRequest();
            var healthBookId=query.healthBookId;
            var babyId=query.babyId;
            var cansubmit=true;
            var regu = "^[0-9]+\.?[0-9]*$";//验证数字和小数
            var re = new RegExp(regu);
            var currYear = (new Date()).getFullYear();
            var opt={};
            opt.date = {preset : 'date'};
            opt.datetime = {preset : 'datetime'};
            opt.time = {preset : 'time'};
            opt.default2 = {
                theme: 'android-ics light', //皮肤样式
                display: 'modal', //显示方式
                mode: 'scroller', //日期选择模式
                dateFormat: 'yy-mm-dd',
                lang: 'zh',
                showNow: true,
                nowText: "今天",
                startYear: currYear - 2, //开始年份
                endYear: currYear + 3 //结束年份
            };
            $(".content_table input").mobiscroll($.extend(opt['date'], opt['default2']));
            //回显
            $.ajax({
                type:"post",
                url: localhostUrl+'/web-bin/m/nosen/followup/maternalChild/handBook/query_babyTeethRecord_data?healthBookId='+healthBookId+'&babyId='+babyId,
                dataType:'json',
                async:false,
                contentType:'application/json;charset=UTF-8',
                success:function(data){
                    if(data.res==0){
                        var msg=data.data;
                        $('#data_id').val(msg&&msg.id);
                        if(msg!=null){
                            for(var o in msg){
                                $("#"+o).val(msg[o]);
                            }
                        }
                    }else{
                        fake_alert("请求失败！请检查网络是否正常。");
                    }
                },
                error:function () {
                    fake_alert("请求失败！请检查网络是否正常。");
                    return;
                }
            });
            //保存
            $('.save').click(function(){
                var startTeethMonth=$('#startTeethMonth').val();
                if(startTeethMonth!=''&& !re.test(startTeethMonth)){
                    fake_alert("开始长牙月龄必须是数字","#startTeethMonth");
                    return false;
                }
                if(/.*[\u4e00-\u9fa5]+.*$/.test(startTeethMonth)){
                    fake_alert("开始长牙月龄必须是数字","#startTeethMonth");
                    return false;
                }
                var JsonObj=$("#myForm").serializeObject();
                JsonObj.healthBookId=healthBookId;
                JsonObj.id=$('#data_id').val();
                JsonObj.babyId=babyId;
                var data_id=$("#data_id").val();
                if(cansubmit){
                    cansubmit=false;
                    $.ajax({
                        type:"post",
                        url: localhostUrl+'/web-bin/m/nosen/followup/maternalChild/handBook/submit_babyTeethRecord_data',
                        data:JsonObj,
                        contentType:'application/json;charset=UTF-8',
                        success:function(data){
                            console.log(data);
                            if(data.res==0){
                                fake_alert("保存成功");
                                setTimeout(function(){
                                    window.history.go(-1);
                                },500)
                            }else{
                                fake_alert("保存失败！请检查网络是否正常。");
                                cansubmit=false;
                            }
                        },
                        error:function () {
                            fake_alert("保存失败！请检查网络是否正常。");
                            cansubmit=false;
                            return;
                        }
                    });
                }
            })
        })
        function fake_alert(text,element){
            $("#background").show();
            $("#fake_alert").show();
            $("#msg").html(text);
            $("#sure").click(function(){
                $("#background").hide();
                $("#fake_alert").hide();
            });
            element&&$("html,body").animate({scrollTop:$(element).offset().top-75},500);
        }
    </script>
</body>
</html>